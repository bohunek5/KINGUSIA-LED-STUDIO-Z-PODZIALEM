<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kingusia LED Studio â€” Projektuj oÅ›wietlenie</title>
    <meta name="description"
        content="Studio projektowania oÅ›wietlenia LED z podziaÅ‚em na pomieszczenia i AI asystentem Ollama." />
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ’¡</text></svg>" />
    <link rel="stylesheet" href="style.css" />
</head>

<body>

    <header id="app-header">
        <a class="logo-wrap" href="#">
            <div class="logo-icon">ğŸ’¡</div>
            <span class="logo-text">KINGUSIA <span>LED</span> STUDIO</span>
        </a>
        <div class="header-divider"></div>
        <div class="header-status">
            <div class="status-dot" id="status-dot"></div>
            <span id="status-label">Sprawdzam Ollamaâ€¦</span>
        </div>
        <button class="header-btn" id="add-room-header-btn">â• Dodaj pomieszczenie</button>
        <button class="header-btn" id="export-btn">ğŸ“„ Eksport wyceny</button>
    </header>

    <aside id="sidebar">
        <div class="sidebar-head">
            <span class="sidebar-title">ğŸ  Pomieszczenia</span>
            <button id="add-room-btn" title="Dodaj pomieszczenie">+</button>
        </div>
        <div id="rooms-list"></div>
        <div class="sidebar-footer">
            <div class="sidebar-total">
                <span>Szacunkowy koszt:</span>
                <strong id="sidebar-total">0,00 zÅ‚</strong>
            </div>
        </div>
    </aside>

    <main id="main">
        <div class="main-scroll" id="main-content"></div>
        <div class="summary-bar">
            <div class="summary-item"><span class="s-label">PomieszczeÅ„</span><span class="s-val"
                    id="sum-rooms">0</span></div>
            <div class="summary-divider"></div>
            <div class="summary-item"><span class="s-label">ÅÄ…czna dÅ‚ugoÅ›Ä‡</span><span class="s-val" id="sum-length">0
                    m</span></div>
            <div class="summary-divider"></div>
            <div class="summary-item"><span class="s-label">ÅÄ…czna moc</span><span class="s-val" id="sum-power">0
                    W</span></div>
            <div class="summary-divider"></div>
            <div class="summary-item"><span class="s-label">Koszt caÅ‚kowity</span><span class="s-val" id="sum-cost"
                    style="color:var(--orange)">0 zÅ‚</span></div>
        </div>
    </main>

    <aside id="chat-panel">
        <div class="chat-head">
            <div class="chat-avatar">âœ¨</div>
            <div class="chat-title-wrap">
                <div class="chat-name">Kingusia AI</div>
                <div class="chat-subtitle">Doradca oÅ›wietlenia LED</div>
            </div>
            <div class="chat-model-badge" id="model-badge">Å‚adowanieâ€¦</div>
        </div>

        <!-- CORS/Offline banner -->
        <div id="ollama-offline-banner">
            <div style="font-size:12px;color:var(--danger);font-weight:600">âš ï¸ Ollama offline lub brak CORS</div>
            <div class="cors-fix-box">
                <strong>Uruchom Ollama z obsÅ‚ugÄ… CORS:</strong>
                <code id="cors-cmd"
                    title="Kliknij aby skopiowaÄ‡">OLLAMA_ORIGINS="https://bohunek5.github.io" ollama serve</code>
                <div style="display:flex;gap:6px;margin-top:8px;align-items:center">
                    <span style="font-size:10px;color:var(--text-3);white-space:nowrap">URL Ollamy:</span>
                    <input id="ollama-url-input" type="text" class="ollama-url-input" value="http://localhost:11434" />
                    <button id="ollama-url-save" class="ollama-url-save">Zapisz â†º</button>
                </div>
            </div>
        </div>

        <div id="chat-messages">
            <div class="chat-msg ai">
                <div class="msg-avatar">âœ¨</div>
                <div class="msg-bubble">
                    CzeÅ›Ä‡! Jestem Kingusia â€” TwÃ³j doradca oÅ›wietlenia LED. ğŸŒŸ<br /><br />
                    Powiedz mi dla jakiego pomieszczenia projektujesz oÅ›wietlenie â€” pomogÄ™ dobraÄ‡ taÅ›mÄ™, profil i
                    zasilacz!
                </div>
            </div>
        </div>

        <div class="quick-prompts">
            <button class="qp-btn" onclick="sendQuickPrompt('Jaka temperatura barwowa do salonu?')">ğŸ›‹ï¸ Salon</button>
            <button class="qp-btn" onclick="sendQuickPrompt('JakÄ… taÅ›mÄ™ wybraÄ‡ do Å‚azienki? Jaki stopieÅ„ IP?')">ğŸ›
                Åazienka</button>
            <button class="qp-btn" onclick="sendQuickPrompt('Jak obliczyÄ‡ moc zasilacza do taÅ›my LED?')">âš¡
                Zasilacz</button>
            <button class="qp-btn" onclick="sendQuickPrompt('RÃ³Å¼nica miÄ™dzy COB a SMD LED?')">ğŸ’¡ COB vs SMD</button>
            <button class="qp-btn" onclick="sendQuickPrompt('ZrÃ³b podsumowanie mojego projektu')">ğŸ“‹
                Podsumowanie</button>
        </div>

        <div class="chat-input-wrap">
            <textarea id="chat-input" rows="1" placeholder="Zapytaj o oÅ›wietlenieâ€¦"></textarea>
            <button id="chat-send" title="WyÅ›lij (Enter)">â¤</button>
        </div>
    </aside>

    <div class="modal-overlay" id="modal-overlay">
        <div class="modal" role="dialog">
            <div class="modal-title">ğŸ  Dodaj pomieszczenie</div>
            <div class="modal-field">
                <label class="modal-label">Typ pomieszczenia</label>
                <div class="icon-picker" id="icon-picker"></div>
            </div>
            <div class="modal-field">
                <label class="modal-label" for="modal-room-name">Nazwa pomieszczenia</label>
                <input class="modal-input" id="modal-room-name" type="text" placeholder="np. Salon, Sypialnia gÅ‚Ã³wnaâ€¦"
                    maxlength="40" />
            </div>
            <div class="modal-actions">
                <button class="modal-cancel" id="modal-cancel-btn">Anuluj</button>
                <button class="modal-confirm" id="modal-confirm-btn">âœ“ Dodaj</button>
            </div>
        </div>
    </div>

    <script src="ollama.js"></script>
    <script src="app.js"></script>
    <script>
        // CORS cmd copy on click
        document.getElementById('cors-cmd')?.addEventListener('click', function () {
            navigator.clipboard.writeText(this.textContent).then(() => {
                this.style.color = '#2ECC71';
                setTimeout(() => this.style.color = '', 1000);
            });
        });
        // Save custom Ollama URL
        document.getElementById('ollama-url-save')?.addEventListener('click', function () {
            const url = document.getElementById('ollama-url-input').value.trim();
            if (url) {
                OllamaClient.setBaseUrl(url);
                updateOllamaStatus();
            }
        });
    </script>
</body>

</html>